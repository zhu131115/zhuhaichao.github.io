<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>朱海潮网</title>
		<style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 2rem auto; padding: 1rem }
        #message { width: 100%; height: 100px; padding: 10px; margin-bottom: 10px }
        .post { border: 1px solid #eee; padding: 1rem; margin-bottom: 1rem; border-radius: 5px }
        .delete-btn { color: #dc3545; cursor: pointer; float: right }
        .timestamp { color: #6c757d; font-size: 0.8em; display: block; margin-top: 8px }
    </style>
	</head>
	<body>
		<h1>欢迎</h1>
		<p>在此声明本站基于github的网站功能</p>
		<p>你们可以在这说点什么</p>
	
</head>
<body>
<textarea id="message" placeholder="输入你的留言..."></textarea>
    <button onclick="submitMessage()">提交留言</button>
    <div id="messages"></div>

    <script>
        // ⚠️ 安全警告：生产环境应使用服务端代理
        const config = {
            owner: 'zhu131115',     // 替换为你的GitHub用户名
            repo: 'zhuhaichao.github.io',       // 替换为你的仓库名
            token: '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'       // 替换为你的GitHub Token
        };

        // 提交留言
        async function submitMessage() {
            const input = document.getElementById('message');
            const content = input.value.trim();
            
            if (!content) return alert('请输入留言内容');
            
            const response = await fetch(`https://api.github.com/repos/${config.owner}/${config.repo}/issues`, {
                method: 'POST',
                headers: {
                    'Authorization': `token ${config.token}`,
                    'Accept': 'application/vnd.github.v3+json'
                },
                body: JSON.stringify({
                    title: `留言-${Date.now()}`,
                    body: content
                })
            });

            if (response.ok) {
                input.value = '';
                loadMessages();
            } else {
                alert('提交失败，请查看控制台错误');
                console.error(await response.json());
            }
        }

        // 加载留言
        async function loadMessages() {
            const response = await fetch(`https://api.github.com/repos/${config.owner}/${config.repo}/issues`);
            const issues = await response.json();
            
            const container = document.getElementById('messages');
            container.innerHTML = issues
                .filter(i => !i.pull_request)
                .map(i => `
                    <div class="post">
                        <div>${marked.parse(i.body)}</div>
                        <span class="timestamp">
                            ${new Date(i.created_at).toLocaleString()} 
                            #${i.number}
                        </span>
                    </div>
                `).join('');
        }

        // 初始化加载
        loadMessages();
    </script>
    
    <!-- Markdown 解析库 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
	</body>
</html>
